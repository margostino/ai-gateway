# AI Gateway

AI Gateway is a NodeJS/Typescript application that allows HTTPS routing to different Language Learning Model (LLM) providers such as OpenAI. It provides a unified interface to interact with different AI providers, abstracting the complexity of managing different API keys and endpoints.

Currently, the gateway only supports **OpenAI** with the base URL `https://api.openai.com` and the following paths:

- `/v1/models` (GET)
- `/v1/chat/completions` (POST)
- `/v1/embeddings` (POST)

Users of the AI Gateway are required to use an API key generated by the Gateway. The Gateway will internally manage the API key for every provider.


## Local Development

These instructions will get you a copy of the project up and running on your local machine for development and testing purposes.

### Prerequisites

- Node.js (v18 or later)
- npm (v10 or later)

### Installation

1. Install the dependencies:

```bash
yarn install
```

2. Create a `.env` file in the root directory of the project as it is described in `.env.example`.

3. Start the server:

```bash
yarn dev
```

The server will start running at `http://localhost:8080`.

Admin will start at `http://localhost:8081`.

### Run tests

```bash
yarn test
```

## Usage

To use the AI Gateway, you need to make HTTP requests to the Gateway's endpoints. Here are some examples:

- To get a list of models:

```bash
curl -X GET http://localhost:3000/openai/v1/models -H 'Authorization: Bearer {AI_GATEWAY_API_KEY}
```

- To create a chat completion: the payload is the Provider specific payload. For OpenAI, it is described [here](https://platform.openai.com/docs/api-reference/chat/create).

```bash
curl -X POST http://localhost:3000/openai/v1/chat/completions -H 'Authorization: Bearer {AI_GATEWAY_API_KEY}' -d '{...}'
```

- To create an embedding:

```bash
curl -X POST http://localhost:3000/openai/v1/embeddings -H 'Authorization: Bearer {AI_GATEWAY_API_KEY}' -d '{...}'
```

Replace `{AI_GATEWAY_API_KEY}` with the API key generated by the AI Gateway.

### How to generate API Key for AI Gateway

An API key can be generated with the script `./scrips/api-key-generator.py` and stored in `./provision/secrets/hashed-api-keys.json`.
The key will be used by the Gateway to authenticate the user based on the authorized scopes.

For now, only OpenAI provider is supported with the scopes:

- `get:/openai/v1/models`
- `post:/openai/v1/chat/completions`
- `post:/openai/v1/embeddings`
- ALL (all of the above)

```bash
python ./scripts/api-key-generator.py {username|systemId} {scopes|all}
```

**Example:**

```bash
python ./scripts/api-key-generator.py john.doe all
```

Or scope specific:

```bash
python ./scripts/api-key-generator.py john.doe get:/openai/v1/models
```